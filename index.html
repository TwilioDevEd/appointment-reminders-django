<!DOCTYPE html><html><head><title>Appointment Reminders</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Appointment Reminders"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Appointment Reminders</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement appointment reminders in your web app with Twilio. Appointment reminders allow you to automate the process of reaching out to your customers in advance of an upcoming appointment.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Create an Appointment" class="chapter"><div data-title="Introduction" class="step"><h2 id="how-it-works">How It Works</h2>
<p>Ready to implement appointment reminders in your application? Here&#39;s how it works at a high level:</p>
<ol>
<li>An administrator (our user) creates an appointment for a future date and time, and stores a customer&#39;s phone number in the database for that appointment</li>
<li>When that appointment is saved a background task is scheduled to send a reminder to that customer before their appointment starts</li>
<li>At a configured time in advance of the appointment, the background task sends an SMS reminder to the customer to remind them of their appointment</li>
</ol>
<h2 id="building-blocks">Building Blocks</h2>
<p>Here are the technologies we&#39;ll use:</p>
<ul>
<li><a href="https://www.djangoproject.com/">Django</a> to create a database-driven web application</li>
<li><a href="/docs/api/rest/sending-sms">The Messages Resource</a> from Twilio&#39;s REST API to send text messages</li>
<li><a href="http://www.celeryproject.org/">Celery</a> to help us schedule and execute background tasks on a recurring basis</li>
</ul>
<h2 id="how-to-read-this-tutorial">How To Read This Tutorial</h2>
<p>To implement appointment reminders, we will be working through a series of <a href="http://en.wikipedia.org/wiki/User_story">user stories</a> that describe how to fully implement appointment reminders in a web application.</p>
<p>We&#39;ll walk through the code required to satisfy each story, and explore what we needed to add at each step.</p>
<p>Let&#39;s get started! Click the right arrow to move on to the next step of the tutorial.</p>
</div><div data-title="Meet our stack" data-file="requirements.txt" class="step"><h2 id="meet-our-stack">Meet our stack</h2>
<p>We&#39;re building this app for Django 1.8 on Python 3.4, but all our code works in Python 2.7 too. We&#39;re big fans of <a href="http://twoscoopspress.org/products/two-scoops-of-django-1-8">Two Scoops of Django</a> and we will use many best practices outlined there.</p>
<p>In addition to Celery, we will use a few other Python libraries to make our task easier:</p>
<ul>
<li>The <a href="https://github.com/twilio/twilio-python">twilio-python</a> Python helper library</li>
<li><a href="https://github.com/mfogel/django-timezone-field">django-timezone-field</a> to give us a model field for storing time zones</li>
<li><a href="https://github.com/dyve/django-bootstrap3">django-bootstrap3</a> and <a href="https://github.com/pinax/django-forms-bootstrap">django-forms-bootstrap</a> to make our form templates simpler and prettier</li>
<li>The fantastic <a href="http://crsmithdev.com/arrow/">arrow</a> library to make our datetime math foolproof</li>
</ul>
<p>We will also use <a href="http://www.postgresql.org/">PostgreSQL</a> for our database and <a href="http://redis.io/">Redis</a> as our <a href="http://docs.celeryproject.org/en/latest/getting-started/brokers/index.html">Celery message broker</a>.</p>
<p>Now let&#39;s get started with our first user story: creating a new user account.</p>
</div><div data-title="The User Story" class="step"><h2>Creating an Appointment</h2><blockquote> 
As a user, I want to create an appointment with a name, guest phone number, and a time in the future.</blockquote><p>To build an automated appointment reminder app, we probably should start with an appointment. This story requires that we create a model object and a bit of the user interface to create and save a new <code>Appointment</code> in our system.</p>
<p>At a high level, here&#39;s what we will need to add:</p>
<ul>
<li>An <code>Appointment</code> model to store information we need to send the reminder</li>
<li>A view to render our form and accept POST data from it</li>
<li>An HTML form to enter details about the appointment</li>
</ul>
<p>Let&#39;s start by looking at the model.</p>
</div><div data-title="The Appointment model" data-file="reminders/models.py" data-highlight="14-26" data-language="python" class="step"><h2 id="the-appointment-model">The Appointment Model</h2>
<p>We only need to store four pieces of data about each appointment to send a reminder:</p>
<ul>
<li>The customer&#39;s name</li>
<li>Their phone number</li>
<li>The date and time of their appointment</li>
<li>The time zone of the appointment</li>
</ul>
<p>We also included two additional fields: <code>task_id</code> and <code>created</code>. The <code>task_id</code> field will help us keep track of the corresponding reminder task for this appointment. The <code>created</code> field is just a timestamp populated when an appointment is created.</p>
<p>Finally, we defined a <code>__str__</code> method to tell Django how to represent instances of our model as text. This method uses the primary key and the customer&#39;s name to create a readable representation of an appointment.</p>
<p><strong>Python 2/3 Compatibility</strong></p>
<p>To keep our project compatible with Python 2, we use the <code>python_2_unicode_compatible</code> decorator on our model.</p>
<p>This decorator tells Django to use our model&#39;s <code>__str__</code> method to make a <code>__unicode__</code> method when needed for Python 2.</p>
<p>You can read more about it in the <a href="https://docs.djangoproject.com/en/1.8/topics/python3/#str-and-unicode-methods">Porting to Python 3</a> section of the Django documentation.</p>
</div><div data-title="New appointment view" data-file="reminders/views.py" data-highlight="21-26" data-language="python" class="step"><h2 id="new-appointment-view">New appointment view</h2>
<p>The next step in getting our <code>Appointment</code> model out to the world is writing a view.</p>
<p>Django lets developers write views as <a href="https://docs.djangoproject.com/en/1.8/topics/http/views/">functions</a> or <a href="https://docs.djangoproject.com/en/1.8/topics/class-based-views/">classes</a>.</p>
<p>Class-based views are great when your views need to support simple, <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD-like</a> features - perfect for our appointments project.</p>
<p>To make a view for creating new <code>Appointment</code> objects, we&#39;ll use Django&#39;s generic <a href="https://docs.djangoproject.com/en/1.8/ref/class-based-views/generic-editing/#django.views.generic.edit.CreateView">CreateView</a> class.</p>
<p>All we need to specify is the model it should use and what fields it should include. We don&#39;t even need to declare a form - Django will use a <a href="https://docs.djangoproject.com/en/1.8/topics/forms/modelforms/#modelform">ModelForm</a> for us behind the scenes.</p>
<p><strong>Success messages</strong></p>
<p>Our view is ready to go with just those first three lines of code, but we&#39;ll make it a little better by adding the <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/messages/#adding-messages-in-class-based-views">SuccessMessageMixin</a>.</p>
<p>This mixin tells our view to pass the <code>success_message</code> property of our class to the <a href="https://docs.djangoproject.com/en/1.8/ref/contrib/messages/">Django messages framework</a> after a successful creation. We will display those messages to the user in our templates.</p>
</div><div data-title="Wiring up the URLs" data-file="reminders/urls.py" data-highlight="11-12" data-language="python" class="step"><h2 id="wiring-up-the-urls">Wiring up the URLs</h2>
<p>Now that we have a view to create new appointments, we need to add a new URL to our URL dispatcher so users can get to it.</p>
<p>To satisfy the appointment creation user story, we&#39;ll create a new URL at <code>/new</code> and point it to our <code>AppointmentCreateView</code>.</p>
<p>Because we&#39;re using a class-based view, we pass our view to our URL with the <code>.as_view()</code> method instead of just using the view&#39;s name.</p>
</div><div data-title="New appointment form" data-file="templates/reminders/appointment_form.html" data-language="htmlembedded" class="step"><h2 id="new-appointment-form">New appointment form</h2>
<p>The last big piece we need to let our users create new appointments is the HTML form.</p>
<p>Our form template inherits from our base template, which you can check out at <code>templates/base.html</code>.</p>
<p>We&#39;re using <a href="http://getbootstrap.com/">Bootstrap</a> for the front end of our app, and we use the <a href="https://github.com/pinax/django-forms-bootstrap">django-forms-bootstrap</a> library to help us render our form with the <code>|as_bootstrap_horizontal</code> template filter.</p>
<p>By naming this file <code>appointment_form.html</code>, our <code>AppointmentCreateView</code> will automatically use this template when rendering its response. If you want to name your template something else, you can specify its name by adding a <code>template_name</code> property on our view class.</p>
<p>We&#39;ll use this same template with our update view in the next chapter.</p>
</div><div data-title="Appointment form datepicker" data-file="templates/reminders/appointment_form.html" data-highlight="40-57" data-language="htmlembedded" class="step"><h2 id="appointment-form-datepicker">Appointment form datepicker</h2>
<p>To make it easier for our users to enter the date and time of an appointment, we&#39;ll use a JavaScript datepicker widget.</p>
<p>In this case, <a href="https://eonasdan.github.io/bootstrap-datetimepicker/">bootstrap-datetimepicker</a> is a good fit. We include the necessary CSS and JS files from content delivery networks and then add a little custom JavaScript to initialize the widget on the form input for our time field.</p>
</div><div data-title="Adding a get_absolute_url method" data-file="reminders/models.py" data-highlight="14-29" data-language="python" class="step"><h2 id="adding-a-get_absolute_url-method">Adding a get_absolute_url method</h2>
<p>When a user clicks &quot;Submit&quot; on our new appointment form, their input will be received by our <code>AppointmentCreateView</code> and then validated against the fields we specified in our <code>Appointment</code> model.</p>
<p>If everything looks good, Django will save the new appointment to the database. We need to tell our <code>AppointmentCreateView</code> where to send our user next.</p>
<p>We could specify a <code>success_url</code> property on our <code>AppointmentCreateView</code>, but by default Django&#39;s <a href="https://docs.djangoproject.com/en/1.8/ref/class-based-views/mixins-editing/#django.views.generic.edit.ModelFormMixin.get_success_url">CreateView</a> class will use the newly created object&#39;s <code>get_absolute_url</code> method to figure out where to go next.</p>
<p>So we&#39;ll define a <code>get_absolute_url</code> method on our <code>Appointment</code> model, which uses Django&#39;s <a href="https://docs.djangoproject.com/en/1.8/ref/urlresolvers/#reverse">reverse</a> utility function to build a URL for this appointment&#39;s detail page. You can see that template at <code>templates/reminders/appointment_detail.html</code>.</p>
<p>And now our users are all set to create new appointments. In the next section, we&#39;ll quickly implement a few other basic features: listing, updating, and deleting appointments.</p>
</div></div><div data-title="Interacting with Appointments" class="chapter"><div data-title="Interacting with Appointments" data-file="reminders/views.py" data-language="python" class="step"><h2>Interacting with Appointments</h2><blockquote> 
As a user, I want to view a list of all future appointments, and be able to edit and delete those appointments.</blockquote><p>If you&#39;re an organization that handles a lot of appointments, you probably want to be able to view and manage them in a single interface. That&#39;s what we&#39;ll tackle in this user story. We&#39;ll create a UI to:</p>
<ul>
<li>Show all appointments</li>
<li>Edit individual appointments</li>
<li>Delete individual appoinments</li>
</ul>
<p>Because these are basic <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD-like</a> operations, we&#39;ll keep using <a href="https://docs.djangoproject.com/en/1.8/topics/class-based-views/generic-editing/#model-forms">Django&#39;s generic class-based views</a> to save us a lot of work.</p>
</div><div data-title="Showing a list of appointments" data-file="reminders/views.py" data-highlight="5-12" data-language="htmlembedded" class="step"><h2 id="showing-a-list-of-appointments">Showing a list of appointments</h2>
<p>Let&#39;s tackle showing a list of appointments first.</p>
<p>Django&#39;s <a href="https://docs.djangoproject.com/en/1.8/ref/class-based-views/generic-display/#listview">ListView</a> class was born for this.</p>
<p>All we need to do it point it at our <code>Appointment</code> model and it will handle building a QuerySet of all appointments for us.</p>
<p>And wiring up this view in our <code>reminders/urls.py</code> module is just as easy as our <code>AppointmentCreateView</code>:</p>
<pre><code class="cm-s-monokai lang-python"><span class="cm-keyword">from</span> .<span class="cm-variable">views</span> <span class="cm-keyword">import</span> <span class="cm-variable">AppointmentListView</span>

<span class="cm-variable">url</span>(<span class="cm-string">r&#39;^$&#39;</span>, <span class="cm-variable">AppointmentListView</span>.<span class="cm-variable">as_view</span>(), <span class="cm-variable">name</span>=<span class="cm-string">&#39;list_appointments&#39;</span>),
</code></pre>
<p>If we name our template file <code>appointment_list.html</code> our <code>AppointmentListView</code> will find it automatically. Let&#39;s check it out next.</p>
</div><div data-title="Appointment list template" data-file="templates/reminders/appointment_list.html" data-language="htmlembedded" class="step"><h2 id="appointment-list-template">Appointment list template</h2>
<p>Our <code>AppointmentListView</code> passes its list of appointment objects to our template in the <code>object_list</code> variable.</p>
<p>If that variable is empty, we include a <code>&lt;p&gt;</code> tag saying there are no upcoming appointments.</p>
<p>Otherwise we populate a table with a row for each appointment in our list. We can use our handy <code>get_absolute_url</code> method again to include a link to each appointment&#39;s detail page.</p>
<p>We also use the <a href="https://docs.djangoproject.com/en/1.8/ref/templates/builtins/#url">{% url %}</a> template tag to include links to our edit and delete views.</p>
<p>And now that our appointment listing requirement is complete, let&#39;s cover how to build those views next.</p>
</div><div data-title="Tweaking our form template" data-file="templates/reminders/appointment_form.html" data-highlight="44-57" data-language="htmlembedded" class="step"><h2 id="tweaking-our-form-template">Tweaking our form template</h2>
<p>Django&#39;s <a href="https://docs.djangoproject.com/en/1.8/ref/class-based-views/generic-editing/#django.views.generic.edit.UpdateView">UpdateView</a> makes it easy to add a view for updating appointments. Our form template needs a few tweaks, though, to handle prepopulated data from an existing appointment.</p>
<p>Django will store our datetimes precisely, down to the second, but we don&#39;t want to bother our users by forcing them to pick the precise second an appointment starts.</p>
<p>To fix this problem we use the <a href="https://eonasdan.github.io/bootstrap-datetimepicker/Options/#extraformats">extraFormats configuration option</a> of bootstrap-datetimepicker. </p>
<p>By configuring our datetimepicker with a <code>format</code> value that doesn&#39;t ask users for seconds, and an <code>extraFormat</code> value that does accept datetimes with seconds, our form will populate correctly when Django provides a full datetime to our template.</p>
</div><div data-title="Delete view" data-file="reminders/views.py" data-language="python" class="step"><h2 id="delete-view">Delete view</h2>
<p><a href="https://docs.djangoproject.com/en/1.8/ref/class-based-views/generic-editing/#django.views.generic.edit.DeleteView">DeleteView</a> is an especially handy view class. It shows users a confirmation page before deleting the specified object.</p>
<p>Like UpdateView, DeleteView finds the object to delete by using the <code>pk</code> parameter in its URL, declared in <code>reminders/urls.py</code>:</p>
<pre><code class="cm-s-monokai lang-python"><span class="cm-keyword">from</span> .<span class="cm-variable">views</span> <span class="cm-keyword">import</span> <span class="cm-variable">AppointmentDeleteView</span>

<span class="cm-variable">url</span>(<span class="cm-string">r&#39;^/(?P&lt;pk&gt;[0-9]+)/delete$&#39;</span>, <span class="cm-variable">AppointmentDeleteView</span>.<span class="cm-variable">as_view</span>(), <span class="cm-variable">name</span>=<span class="cm-string">&#39;delete_appointment&#39;</span>),
</code></pre>
<p>We also need to specify a <code>success_url</code> property on our view class. This property tells Django where to send users after a successful deletion. In our case, we&#39;ll send them back to the list of appointments at the URL named <code>list_appointments</code>.</p>
<p>When a Django project starts running, it evaluates views before URLs, so we need to use the <a href="https://docs.djangoproject.com/en/1.8/ref/urlresolvers/#reverse-lazy">reverse_lazy</a> utility function to get our appointment list URL instead of <code>reverse</code>.</p>
<p>By default, our <code>AppointmentDeleteView</code> will look for a template named <code>appointment_confirm_delete.html</code>. You can check out ours in the <code>templates/reminders</code> directory.</p>
<p>And that closes out this user story.</p>
<p>Our users now have everything they need to manage appointments - all that&#39;s left to implement is sending the reminders.</p>
</div></div><div data-title="Send a Reminder" class="chapter"><div data-title="Sending the Reminder" data-file="reminders/tasks.py" data-language="python" class="step"><h2>Sending the Reminder</h2><blockquote>As an appointment system, I want to notify a customer via SMS an arbitrary interval before a future appointment.</blockquote><p>To satisfy this user story, we need to make our application work asynchronously - on its own independent of any individual user interaction.</p>
<p>The most popular Python library for asynchronous tasks is <a href="http://www.celeryproject.org/">Celery</a>. To integrate Celery with our application, we need to make a few changes:</p>
<ul>
<li>Create a new function that sends an SMS message using information from an <code>Appointment</code> object</li>
<li>Register that function as a task with Celery so it can be executed asynchronously</li>
<li>Run a separate Celery worker process alongside our Django application to call our SMS reminder function at the right time for each appointment</li>
</ul>
<p>If you&#39;re brand new to Celery, you might want to skim its <a href="http://docs.celeryproject.org/en/latest/getting-started/introduction.html">Introduction to Celery</a> page before proceeding.</p>
</div><div data-title="Setting up Celery" data-file="appointments/settings/common.py" data-language="python" data-highlight="29-31" class="step"><h2 id="setting-up-celery">Setting up Celery</h2>
<p>Celery and Django are both big Python projects, but they can work together easily.</p>
<p><a href="http://docs.celeryproject.org/en/latest/django/first-steps-with-django.html">By following the instructions in the Celery docs</a>, we can include our Celery settings in our Django settings modules. We can also write our Celery tasks in <code>tasks.py</code> modules that live inside our Django apps, which keeps our project layout consistent and simple.</p>
<p>To use Celery, you also need a separate service to be your message broker. We used <a href="http://docs.celeryproject.org/en/latest/getting-started/brokers/redis.html#broker-redis">Redis</a> for this project.</p>
<p>The two Celery-specific settings in our <code>common.py</code> settings module are <code>BROKER_URL</code> and <code>BROKER_POOL_LIMIT</code>.</p>
<p><code>BROKER_POOL_LIMIT</code> limits how many connections Celery will make to our broker - useful when deploying to a Platform-as-a-Service (PaaS) like <a href="https://www.heroku.com/">Heroku</a> where the free tiers of Redis services limit your application to a handful of connections.</p>
<p>If you want to see all the steps to get Django, Celery, Redis, and Postgres working on your machine <a href="https://github.com/TwilioDevEd/appointment-reminders-django">check out the README for this project on GitHub</a>.</p>
</div><div data-title="Creating a Celery task" data-file="reminders/tasks.py" data-highlight="15-25" data-language="python" class="step"><h2 id="creating-a-celery-task">Creating a Celery task</h2>
<p>Now that Celery is working with our project, it&#39;s time to write a new task for sending a customer an SMS message about their appointment.</p>
<p>Our task takes an appointment&#39;s ID - it&#39;s primary key - as its only argument. We could pass the <code>Appointment</code> object itself as the argument, but this best practice ensures our SMS will use the most up-to-date version of our appointment&#39;s data.</p>
<p>It also gives us an opportunity to check if the appointment has been deleted before the reminder was sent, which we do at the top of our function. This way we won&#39;t send SMS reminders for appointments that don&#39;t exist anymore.</p>
</div><div data-title="Sending an SMS message" data-file="reminders/tasks.py" data-language="python" class="step"><h2 id="sending-an-sms-message">Sending an SMS message</h2>
<p>The next step in our <code>send_sms_reminder</code> task is to compose the text of our SMS message.</p>
<p>We use the handy <a href="http://crsmithdev.com/arrow/">arrow</a> library to humanize our appointment&#39;s time relative to the present. After that, we use the <a href="https://github.com/twilio/twilio-python">twilio-python</a> library to send our message.</p>
<p>We instantiate a Twilio REST client at the top of the module, which looks for <code>TWILIO_ACCOUNT_SID</code> and <code>TWILIO_AUTH_TOKEN</code> environment variables to authenticate itself. You can find the correct values for you in <a href="https://www.twilio.com/user/account/settings">your account dashboard</a>.</p>
<p>Sending the SMS message itself is as easy as calling <code>client.messages.create()</code>, passing arguments for the body of the SMS message, the receipient&#39;s phone number, and the Twilio phone number you want to send this message from. Twilio will deliver the SMS message immediately.</p>
<p>With our <code>send_sms_reminder</code> task complete, let&#39;s look at how to call it when our appointments are created or updated.</p>
</div><div data-title="Calling our reminder task" data-file="reminders/models.py" data-highlight="39-50" data-language="python" class="step"><h2 id="calling-our-reminder-task">Calling our reminder task</h2>
<p>We added a new method on our <code>Appointment</code> model to help schedule a reminder for an individual appointment.</p>
<p>Our method starts by using <a href="http://crsmithdev.com/arrow/">arrow</a> again to build a new datetime with the appointment&#39;s <code>time</code> and <code>time_zone</code>.</p>
<p>Moving backward in time can be tricky in normal Python, but arrow&#39;s <code>.replace()</code> method lets us easily subtract minutes from our <code>appointment_time</code>. The <code>REMINDER_TIME</code> setting defaults to 30 minutes, and we subtract one more to give our SMS extra time for delivery.</p>
<p>We finish by invoking our Celery task, using the <a href="http://docs.celeryproject.org/en/latest/userguide/calling.html#eta-and-countdown">eta</a> parameter to tell Celery when this task should execute.</p>
<p>We can&#39;t import the <code>send_sms_reminder</code> task at the top of our <code>models.py</code> module because the <code>tasks.py</code> module imports the <code>Appointment</code> model. Importing it in our <code>schedule_reminder</code> method avoids a circular dependency.</p>
</div><div data-title="Overriding the Appointment save method" data-file="reminders/models.py" data-language="python" data-highlight="52-68" class="step"><h2 id="overriding-the-appointment-save-method">Overriding the Appointment save method</h2>
<p>The last thing we need to do is ensure Django calls our <code>schedule_reminder</code> method every time an <code>Appointment</code> object is created or updated.</p>
<p>The best way to do that is to <a href="https://docs.djangoproject.com/en/1.8/topics/db/models/#overriding-predefined-model-methods">override our model&#39;s save method</a>, including an extra call to <code>schedule_reminder</code> after the object&#39;s primary key has been assigned.</p>
<p><strong>Avoiding duplicate or mistimed reminders</strong></p>
<p>Scheduling a Celery task every time an appointment is saved has an unfortunate side effect - our customers will receive duplicate reminders if an appointment was saved more than once. And those reminders could be sent at the wrong time if an appointment&#39;s <code>time</code> field was changed after its creation.</p>
<p>To fix this, we keep track of each appointment&#39;s reminder task through the <code>task_id</code> field, which stores Celery&#39;s unique identifier for each task.</p>
<p>We then look for a previously scheduled task at the top of our custom <code>save</code> method and <a href="http://celery.readthedocs.org/en/latest/faq.html#can-i-cancel-the-execution-of-a-task">revoke</a> it if present.</p>
<p>This guarantees that one and exactly one reminder will be sent for each appointment in our database, and that it will be sent at the most recent <code>time</code> provided for that appointment.</p>
</div><div data-title="Finished" data-file="reminders/models.py" data-language="python" class="step"><h2 id="finished">Finished</h2>
<p>Our appointments project is now complete!</p>
<p>We used <a href="https://docs.djangoproject.com/en/1.8/topics/class-based-views/">Django&#39;s class-based views</a> to help us quickly build out the features to support simple CRUD operations on our <code>Appointment</code> model.</p>
<p>We then integrated <a href="http://www.celeryproject.org/">Celery</a> into our project and used the <a href="https://github.com/twilio/twilio-python">twilio-python</a> helper library to send SMS reminders about our appointments asynchronously.</p>
<p>You&#39;ll find instructions to run this project locally in <a href="https://github.com/TwilioDevEd/appointment-reminders-django">its GitHub README</a>. You can also deploy this project to Heroku in moments by following instructions in the same place.</p>
<p><strong>Feedback</strong></p>
<p>We loved preparing this tutorial and we hope you enjoyed working through it.</p>
<p>Please let us know if it was helpful - or not - by dropping us a note at <a href="mailto:help@twilio.com">help@twilio.com</a>. Thank you!</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="requirements.txt" data-mode="text">IyBSZXF1aXJlbWVudHMgZm9yIHRoZSBhcHBvaW50bWVudHMgRGphbmdvIHByb2plY3QKCiMgRGphbmdvICgxLjggaXMgYSBsb25nLXRlcm0gc3VwcG9ydCByZWxlYXNlKQpEamFuZ289PTEuOAoKIyBUaGlyZC1wYXJ0eSBhcHAgZGVwZW5kZW5jaWVzCmFycm93PT0wLjUuNApjZWxlcnlbcmVkaXNdPT0zLjEuMTgKZGphbmdvLWJvb3RzdHJhcDM9PTUuNC4wCmRqYW5nby1mb3Jtcy1ib290c3RyYXA9PTMuMC4xCmRqYW5nby10aW1lem9uZS1maWVsZD09MS4yCnBzeWNvcGcyPT0yLjYKdHdpbGlvPT00LjQuMAp3aGl0ZW5vaXNlPT0xLjAuNgoKIyBQcm9kdWN0aW9uIGRlcGVuZGVuY2llcwpkai1kYXRhYmFzZS11cmw9PTAuMy4wCmd1bmljb3JuPT0xOS4zLjAKCiMgVGVzdCBkZXBlbmRlbmNpZXMKY292ZXJhZ2U9PTMuNy4xCm1vY2s9PTEuMC4xCm1vZGVsLW1vbW15PT0xLjIuNApzaXg9PTEuOS4wCg==</textarea>
<textarea class="saurus-file" data-file="reminders/models.py" data-mode="python">ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCB1bmljb2RlX2xpdGVyYWxzCgpmcm9tIGFwcG9pbnRtZW50cy5zZXR0aW5ncyBpbXBvcnQgY2VsZXJ5X2FwcApmcm9tIGRqYW5nby5jb25mIGltcG9ydCBzZXR0aW5ncwpmcm9tIGRqYW5nby5jb3JlLmV4Y2VwdGlvbnMgaW1wb3J0IFZhbGlkYXRpb25FcnJvcgpmcm9tIGRqYW5nby5jb3JlLnVybHJlc29sdmVycyBpbXBvcnQgcmV2ZXJzZQpmcm9tIGRqYW5nby5kYiBpbXBvcnQgbW9kZWxzCmZyb20gZGphbmdvLnV0aWxzLmVuY29kaW5nIGltcG9ydCBweXRob25fMl91bmljb2RlX2NvbXBhdGlibGUKZnJvbSB0aW1lem9uZV9maWVsZCBpbXBvcnQgVGltZVpvbmVGaWVsZAoKaW1wb3J0IGFycm93CgoKQHB5dGhvbl8yX3VuaWNvZGVfY29tcGF0aWJsZQpjbGFzcyBBcHBvaW50bWVudChtb2RlbHMuTW9kZWwpOgogICAgbmFtZSA9IG1vZGVscy5DaGFyRmllbGQobWF4X2xlbmd0aD0xNTApCiAgICBwaG9uZV9udW1iZXIgPSBtb2RlbHMuQ2hhckZpZWxkKG1heF9sZW5ndGg9MTUpCiAgICB0aW1lID0gbW9kZWxzLkRhdGVUaW1lRmllbGQoKQogICAgdGltZV96b25lID0gVGltZVpvbmVGaWVsZChkZWZhdWx0PSdVUy9QYWNpZmljJykKCiAgICAjIEFkZGl0aW9uYWwgZmllbGRzIG5vdCB2aXNpYmxlIHRvIHVzZXJzCiAgICB0YXNrX2lkID0gbW9kZWxzLkNoYXJGaWVsZChtYXhfbGVuZ3RoPTUwLCBibGFuaz1UcnVlLCBlZGl0YWJsZT1GYWxzZSkKICAgIGNyZWF0ZWQgPSBtb2RlbHMuRGF0ZVRpbWVGaWVsZChhdXRvX25vd19hZGQ9VHJ1ZSkKCiAgICBkZWYgX19zdHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gJ0FwcG9pbnRtZW50ICN7MH0gLSB7MX0nLmZvcm1hdChzZWxmLnBrLCBzZWxmLm5hbWUpCgogICAgZGVmIGdldF9hYnNvbHV0ZV91cmwoc2VsZik6CiAgICAgICAgcmV0dXJuIHJldmVyc2UoJ3ZpZXdfYXBwb2ludG1lbnQnLCBhcmdzPVtzdHIoc2VsZi5pZCldKQoKICAgIGRlZiBjbGVhbihzZWxmKToKICAgICAgICAiIiJDaGVja3MgdGhhdCBhcHBvaW50bWVudHMgYXJlIG5vdCBzY2hlZHVsZWQgaW4gdGhlIHBhc3QiIiIKCiAgICAgICAgYXBwb2ludG1lbnRfdGltZSA9IGFycm93LmdldChzZWxmLnRpbWUsIHNlbGYudGltZV96b25lLnpvbmUpCgogICAgICAgIGlmIGFwcG9pbnRtZW50X3RpbWUgPCBhcnJvdy51dGNub3coKToKICAgICAgICAgICAgcmFpc2UgVmFsaWRhdGlvbkVycm9yKCdZb3UgY2Fubm90IHNjaGVkdWxlIGFuIGFwcG9pbnRtZW50IGZvciB0aGUgcGFzdC4gUGxlYXNlIGNoZWNrIHlvdXIgdGltZSBhbmQgdGltZV96b25lJykKCiAgICBkZWYgc2NoZWR1bGVfcmVtaW5kZXIoc2VsZik6CiAgICAgICAgIiIiU2NoZWR1bGVzIGEgQ2VsZXJ5IHRhc2sgdG8gc2VuZCBhIHJlbWluZGVyIGFib3V0IHRoaXMgYXBwb2ludG1lbnQiIiIKCiAgICAgICAgIyBDYWxjdWxhdGUgdGhlIGNvcnJlY3QgdGltZSB0byBzZW5kIHRoaXMgcmVtaW5kZXIKICAgICAgICBhcHBvaW50bWVudF90aW1lID0gYXJyb3cuZ2V0KHNlbGYudGltZSwgc2VsZi50aW1lX3pvbmUuem9uZSkKICAgICAgICByZW1pbmRlcl90aW1lID0gYXBwb2ludG1lbnRfdGltZS5yZXBsYWNlKG1pbnV0ZXM9LXNldHRpbmdzLlJFTUlOREVSX1RJTUUgLSAxKQoKICAgICAgICAjIFNjaGVkdWxlIHRoZSBDZWxlcnkgdGFzawogICAgICAgIGZyb20gLnRhc2tzIGltcG9ydCBzZW5kX3Ntc19yZW1pbmRlcgogICAgICAgIHJlc3VsdCA9IHNlbmRfc21zX3JlbWluZGVyLmFwcGx5X2FzeW5jKChzZWxmLnBrLCksIGV0YT1yZW1pbmRlcl90aW1lKQoKICAgICAgICByZXR1cm4gcmVzdWx0LmlkCgogICAgZGVmIHNhdmUoc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKICAgICAgICAiIiJDdXN0b20gc2F2ZSBtZXRob2Qgd2hpY2ggYWxzbyBzY2hlZHVsZXMgYSByZW1pbmRlciIiIgoKICAgICAgICAjIENoZWNrIGlmIHdlIGhhdmUgc2NoZWR1bGVkIGEgcmVtaW5kZXIgZm9yIHRoaXMgYXBwb2ludG1lbnQgYmVmb3JlCiAgICAgICAgaWYgc2VsZi50YXNrX2lkOgogICAgICAgICAgICAjIFJldm9rZSB0aGF0IHRhc2sgaW4gY2FzZSBpdHMgdGltZSBoYXMgY2hhbmdlZAogICAgICAgICAgICBjZWxlcnlfYXBwLmNvbnRyb2wucmV2b2tlKHNlbGYudGFza19pZCkKCiAgICAgICAgIyBTYXZlIG91ciBhcHBvaW50bWVudCwgd2hpY2ggcG9wdWxhdGVzIHNlbGYucGssCiAgICAgICAgIyB3aGljaCBpcyB1c2VkIGluIHNjaGVkdWxlX3JlbWluZGVyCiAgICAgICAgc3VwZXIoQXBwb2ludG1lbnQsIHNlbGYpLnNhdmUoKmFyZ3MsICoqa3dhcmdzKQoKICAgICAgICAjIFNjaGVkdWxlIGEgbmV3IHJlbWluZGVyIHRhc2sgZm9yIHRoaXMgYXBwb2ludG1lbnQKICAgICAgICBzZWxmLnRhc2tfaWQgPSBzZWxmLnNjaGVkdWxlX3JlbWluZGVyKCkKCiAgICAgICAgIyBTYXZlIG91ciBhcHBvaW50bWVudCBhZ2Fpbiwgd2l0aCB0aGUgbmV3IHRhc2tfaWQKICAgICAgICBzdXBlcihBcHBvaW50bWVudCwgc2VsZikuc2F2ZSgqYXJncywgKiprd2FyZ3MpCg==</textarea>
<textarea class="saurus-file" data-file="reminders/views.py" data-mode="python">ZnJvbSBkamFuZ28uY29udHJpYi5tZXNzYWdlcy52aWV3cyBpbXBvcnQgU3VjY2Vzc01lc3NhZ2VNaXhpbgpmcm9tIGRqYW5nby5jb3JlLnVybHJlc29sdmVycyBpbXBvcnQgcmV2ZXJzZV9sYXp5CmZyb20gZGphbmdvLnZpZXdzLmdlbmVyaWMgaW1wb3J0IERldGFpbFZpZXcKZnJvbSBkamFuZ28udmlld3MuZ2VuZXJpYy5lZGl0IGltcG9ydCBDcmVhdGVWaWV3LCBVcGRhdGVWaWV3LCBEZWxldGVWaWV3CmZyb20gZGphbmdvLnZpZXdzLmdlbmVyaWMubGlzdCBpbXBvcnQgTGlzdFZpZXcKCmZyb20gLm1vZGVscyBpbXBvcnQgQXBwb2ludG1lbnQKCmNsYXNzIEFwcG9pbnRtZW50TGlzdFZpZXcoTGlzdFZpZXcpOgogICAgIiIiU2hvd3MgdXNlcnMgYSBsaXN0IG9mIGFwcG9pbnRtZW50cyIiIgoKICAgIG1vZGVsID0gQXBwb2ludG1lbnQKCgpjbGFzcyBBcHBvaW50bWVudERldGFpbFZpZXcoRGV0YWlsVmlldyk6CiAgICAiIiJTaG93cyB1c2VycyBhIHNpbmdsZSBhcHBvaW50bWVudCIiIgoKICAgIG1vZGVsID0gQXBwb2ludG1lbnQKCgpjbGFzcyBBcHBvaW50bWVudENyZWF0ZVZpZXcoU3VjY2Vzc01lc3NhZ2VNaXhpbiwgQ3JlYXRlVmlldyk6CiAgICAiIiJQb3dlcnMgYSBmb3JtIHRvIGNyZWF0ZSBhIG5ldyBhcHBvaW50bWVudCIiIgoKICAgIG1vZGVsID0gQXBwb2ludG1lbnQKICAgIGZpZWxkcyA9IFsnbmFtZScsICdwaG9uZV9udW1iZXInLCAndGltZScsICd0aW1lX3pvbmUnXQogICAgc3VjY2Vzc19tZXNzYWdlID0gJ0FwcG9pbnRtZW50IHN1Y2Nlc3NmdWxseSBjcmVhdGVkLicKCgpjbGFzcyBBcHBvaW50bWVudFVwZGF0ZVZpZXcoU3VjY2Vzc01lc3NhZ2VNaXhpbiwgVXBkYXRlVmlldyk6CiAgICAiIiJQb3dlcnMgYSBmb3JtIHRvIGVkaXQgZXhpc3RpbmcgYXBwb2ludG1lbnRzIiIiCgogICAgbW9kZWwgPSBBcHBvaW50bWVudAogICAgZmllbGRzID0gWyduYW1lJywgJ3Bob25lX251bWJlcicsICd0aW1lJywgJ3RpbWVfem9uZSddCiAgICBzdWNjZXNzX21lc3NhZ2UgPSAnQXBwb2ludG1lbnQgc3VjY2Vzc2Z1bGx5IHVwZGF0ZWQuJwoKCmNsYXNzIEFwcG9pbnRtZW50RGVsZXRlVmlldyhEZWxldGVWaWV3KToKICAgICIiIlByb21wdHMgdXNlcnMgdG8gY29uZmlybSBkZWxldGlvbiBvZiBhbiBhcHBvaW50bWVudCIiIgoKICAgIG1vZGVsID0gQXBwb2ludG1lbnQKICAgIHN1Y2Nlc3NfdXJsID0gcmV2ZXJzZV9sYXp5KCdsaXN0X2FwcG9pbnRtZW50cycpCg==</textarea>
<textarea class="saurus-file" data-file="reminders/urls.py" data-mode="python">ZnJvbSBkamFuZ28uY29uZi51cmxzIGltcG9ydCB1cmwKCmZyb20gLnZpZXdzIGltcG9ydCBBcHBvaW50bWVudExpc3RWaWV3LCBBcHBvaW50bWVudENyZWF0ZVZpZXcsIEFwcG9pbnRtZW50RGV0YWlsVmlldywgQXBwb2ludG1lbnRVcGRhdGVWaWV3LCBBcHBvaW50bWVudERlbGV0ZVZpZXcKCgp1cmxwYXR0ZXJucyA9IFsKICAgICMgTGlzdCBhbmQgZGV0YWlsIHZpZXdzCiAgICB1cmwocideJCcsIEFwcG9pbnRtZW50TGlzdFZpZXcuYXNfdmlldygpLCBuYW1lPSdsaXN0X2FwcG9pbnRtZW50cycpLAogICAgdXJsKHInXi8oP1A8cGs+WzAtOV0rKSQnLCBBcHBvaW50bWVudERldGFpbFZpZXcuYXNfdmlldygpLCBuYW1lPSd2aWV3X2FwcG9pbnRtZW50JyksCgogICAgIyBDcmVhdGUsIHVwZGF0ZSwgZGVsZXRlCiAgICB1cmwocideL25ldyQnLCBBcHBvaW50bWVudENyZWF0ZVZpZXcuYXNfdmlldygpLCBuYW1lPSduZXdfYXBwb2ludG1lbnQnKSwKICAgIHVybChyJ14vKD9QPHBrPlswLTldKykvZWRpdCQnLCBBcHBvaW50bWVudFVwZGF0ZVZpZXcuYXNfdmlldygpLCBuYW1lPSdlZGl0X2FwcG9pbnRtZW50JyksCiAgICB1cmwocideLyg/UDxwaz5bMC05XSspL2RlbGV0ZSQnLCBBcHBvaW50bWVudERlbGV0ZVZpZXcuYXNfdmlldygpLCBuYW1lPSdkZWxldGVfYXBwb2ludG1lbnQnKSwKXQo=</textarea>
<textarea class="saurus-file" data-file="templates/reminders/appointment_form.html" data-mode="html">eyUgZXh0ZW5kcyAiYmFzZS5odG1sIiAlfQoKeyUgbG9hZCBib290c3RyYXBfdGFncyAlfQoKeyUgYmxvY2sgdGl0bGUgJX1OZXcgcmVtaW5kZXJ7JSBlbmRibG9jayB0aXRsZSAlfQoKeyUgYmxvY2sgY29udGVudCAlfQogIDxkaXYgY2xhc3M9InJvdyI+CiAgICA8ZGl2IGNsYXNzPSJjb2wtbGctOSI+CiAgICAgIDxkaXYgY2xhc3M9InBhZ2UtaGVhZGVyIj4KICAgICAgICA8aDE+CiAgICAgICAgICB7JSBpZiBub3Qgb2JqZWN0LnBrICV9CiAgICAgICAgICAgIE5ldyBhcHBvaW50bWVudAogICAgICAgICAgeyUgZWxzZSAlfQogICAgICAgICAgICBFZGl0IGFwcG9pbnRtZW50CiAgICAgICAgICB7JSBlbmRpZiAlfQogICAgICAgICAgPC9oMT4KICAgICAgPC9kaXY+CgogICAgICA8Zm9ybSBjbGFzcz0iZm9ybS1ob3Jpem9udGFsIiBtZXRob2Q9InBvc3QiPgogICAgICAgIHslIGNzcmZfdG9rZW4gJX0KICAgICAgICB7eyBmb3JtfGFzX2Jvb3RzdHJhcF9ob3Jpem9udGFsIH19CiAgICAgICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJjb2wtc20tb2Zmc2V0LTIgY29sLXNtLTEwIj4KICAgICAgICAgICAgPGEgaHJlZj0iI2JhY2siIGNsYXNzPSJidG4gYnRuLWRlZmF1bHQiPkNhbmNlbDwvYT4KICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJzdWJtaXQiIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiPgogICAgICAgICAgICAgIHslIGlmIG5vdCBvYmplY3QucGsgJX0KICAgICAgICAgICAgICAgIENyZWF0ZSBhcHBvaW50bWVudAogICAgICAgICAgICAgIHslIGVsc2UgJX0KICAgICAgICAgICAgICAgIFVwZGF0ZSBhcHBvaW50bWVudAogICAgICAgICAgICAgIHslIGVuZGlmICV9CiAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZm9ybT4KICAgIDwvZGl2PgogIDwvZGl2Pgp7JSBlbmRibG9jayAlfQoKeyUgYmxvY2sgcGFnZV9jc3MgJX0KICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2Jvb3RzdHJhcC1kYXRldGltZXBpY2tlci80LjcuMTQvY3NzL2Jvb3RzdHJhcC1kYXRldGltZXBpY2tlci5taW4uY3NzIiAvPgp7JSBlbmRibG9jayAlfQoKeyUgYmxvY2sgcGFnZV9qcyAlfQogIDxzY3JpcHQgc3JjPSIvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9tb21lbnQuanMvMi4xMC4zL21vbWVudC5taW4uanMiPjwvc2NyaXB0PgogIDxzY3JpcHQgc3JjPSIvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9ib290c3RyYXAtZGF0ZXRpbWVwaWNrZXIvNC43LjE0L2pzL2Jvb3RzdHJhcC1kYXRldGltZXBpY2tlci5taW4uanMiPjwvc2NyaXB0PgoKICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICAgICQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAkKCcjaWRfdGltZScpLmRhdGV0aW1lcGlja2VyKHsKICAgICAgICAgICAgZm9ybWF0OiAnTU0vREQvWVlZWSBISDptbScsCiAgICAgICAgICAgIGV4dHJhRm9ybWF0czogWydZWVlZLU1NLUREIEhIOm1tOnNzJ10sCiAgICAgICAgICAgIHNpZGVCeVNpZGU6IHRydWUKICAgICAgICAgIH0pOwogICAgICB9KTsKICA8L3NjcmlwdD4KeyUgZW5kYmxvY2sgJX0K</textarea>
<textarea class="saurus-file" data-file="templates/reminders/appointment_list.html" data-mode="html">eyUgZXh0ZW5kcyAiYmFzZS5odG1sIiAlfQoKeyUgYmxvY2sgdGl0bGUgJX1VcGNvbWluZyByZW1pbmRlcnN7JSBlbmRibG9jayB0aXRsZSAlfQoKeyUgYmxvY2sgY29udGVudCAlfQogIDxkaXYgY2xhc3M9InJvdyI+CiAgICA8ZGl2IGNsYXNzPSJjb2wtbGctOSI+CgogICAgICA8ZGl2IGNsYXNzPSJwYWdlLWhlYWRlciI+CiAgICAgICAgPGgxPkFwcG9pbnRtZW50czwvaDE+CiAgICAgIDwvZGl2PgoKICAgICAgeyUgaWYgbm90IG9iamVjdF9saXN0ICV9CiAgICAgICAgPHA+PHN0cm9uZz5ObyB1cGNvbWluZyBhcHBvaW50bWVudHMuPC9zdHJvbmc+IFdoeSBub3QgPGEgaHJlZj0ieyUgdXJsICduZXdfYXBwb2ludG1lbnQnICV9Ij5zY2hlZHVsZSBvbmU/PC9hPgogICAgICB7JSBlbmRpZiAlfQoKICAgICAgPHRhYmxlIGNsYXNzPSJ0YWJsZSB0YWJsZS1zdHJpcGVkIj4KICAgICAgICA8dGhlYWQ+CiAgICAgICAgICA8dHI+CiAgICAgICAgICAgIDx0aD5JZDwvdGg+CiAgICAgICAgICAgIDx0aD5OYW1lPC90aD4KICAgICAgICAgICAgPHRoPlBob25lIG51bWJlcjwvdGg+CiAgICAgICAgICAgIDx0aD5UaW1lPC90aD4KICAgICAgICAgICAgPHRoPkNyZWF0ZWQgYXQ8L3RoPgogICAgICAgICAgICA8dGg+QWN0aW9uczwvdGg+CiAgICAgICAgICA8L3RyPgogICAgICAgIDwvdGhlYWQ+CiAgICAgICAgPHRib2R5PgogICAgICAgICAgeyUgZm9yIGFwcG9pbnRtZW50IGluIG9iamVjdF9saXN0ICV9CiAgICAgICAgICAgIDx0cj4KICAgICAgICAgICAgICA8dGQ+PGEgaHJlZj0ie3sgYXBwb2ludG1lbnQuZ2V0X2Fic29sdXRlX3VybCB9fSI+e3sgYXBwb2ludG1lbnQucGsgfX08L2E+PC90ZD4KICAgICAgICAgICAgICA8dGQ+e3sgYXBwb2ludG1lbnQubmFtZSB9fTwvdGQ+CiAgICAgICAgICAgICAgPHRkPnt7IGFwcG9pbnRtZW50LnBob25lX251bWJlciB9fTwvdGQ+CiAgICAgICAgICAgICAgPHRkPnt7IGFwcG9pbnRtZW50LnRpbWUgfX08L3RkPgogICAgICAgICAgICAgIDx0ZD57eyBhcHBvaW50bWVudC5jcmVhdGVkIH19PC90ZD4KICAgICAgICAgICAgICA8dGQ+CiAgICAgICAgICAgICAgICA8YSBjbGFzcz0iYnRuIGJ0bi1kZWZhdWx0IGJ0bi14cyIgaHJlZj0ieyUgdXJsICdlZGl0X2FwcG9pbnRtZW50JyBhcHBvaW50bWVudC5wayAlfSI+RWRpdDwvYT4KICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1kYW5nZXIiIGhyZWY9InslIHVybCAnZGVsZXRlX2FwcG9pbnRtZW50JyBhcHBvaW50bWVudC5wayAlfSI+RGVsZXRlPC9hPgogICAgICAgICAgICAgIDwvdGQ+CiAgICAgICAgICAgIDwvdHI+CiAgICAgICAgICB7JSBlbmRmb3IgJX0KICAgICAgICA8L3Rib2R5PgogICAgICA8L3RhYmxlPgoKICAgICAgPGEgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSIgaHJlZj0ieyUgdXJsICduZXdfYXBwb2ludG1lbnQnICV9Ij5OZXc8L2E+CiAgICA8L2Rpdj4KICA8L2Rpdj4KeyUgZW5kYmxvY2sgJX0K</textarea>
<textarea class="saurus-file" data-file="reminders/tasks.py" data-mode="python">ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhYnNvbHV0ZV9pbXBvcnQKCmZyb20gY2VsZXJ5IGltcG9ydCBzaGFyZWRfdGFzawpmcm9tIGRqYW5nby5jb25mIGltcG9ydCBzZXR0aW5ncwpmcm9tIHR3aWxpby5yZXN0IGltcG9ydCBUd2lsaW9SZXN0Q2xpZW50CgppbXBvcnQgYXJyb3cKCmZyb20gLm1vZGVscyBpbXBvcnQgQXBwb2ludG1lbnQKCgojIFVzZXMgY3JlZGVudGlhbHMgZnJvbSB0aGUgVFdJTElPX0FDQ09VTlRfU0lEIGFuZCBUV0lMSU9fQVVUSF9UT0tFTgojIGVudmlyb25tZW50IHZhcmlhYmxlcwpjbGllbnQgPSBUd2lsaW9SZXN0Q2xpZW50KCkKCkBzaGFyZWRfdGFzawpkZWYgc2VuZF9zbXNfcmVtaW5kZXIoYXBwb2ludG1lbnRfaWQpOgogICAgIiIiU2VuZCBhIHJlbWluZGVyIHRvIGEgcGhvbmUgdXNpbmcgVHdpbGlvIFNNUyIiIgogICAgIyBHZXQgb3VyIGFwcG9pbnRtZW50IGZyb20gdGhlIGRhdGFiYXNlCiAgICB0cnk6CiAgICAgICAgYXBwb2ludG1lbnQgPSBBcHBvaW50bWVudC5vYmplY3RzLmdldChwaz1hcHBvaW50bWVudF9pZCkKICAgIGV4Y2VwdCBBcHBvaW50bWVudC5Eb2VzTm90RXhpc3Q6CiAgICAgICAgIyBUaGUgYXBwb2ludG1lbnQgd2Ugd2VyZSB0cnlpbmcgdG8gcmVtaW5kIHNvbWVvbmUgYWJvdXQKICAgICAgICAjIGhhcyBiZWVuIGRlbGV0ZWQsIHNvIHdlIGRvbid0IG5lZWQgdG8gZG8gYW55dGhpbmcKICAgICAgICByZXR1cm4KCiAgICBhcHBvaW50bWVudF90aW1lID0gYXJyb3cuZ2V0KGFwcG9pbnRtZW50LnRpbWUsIGFwcG9pbnRtZW50LnRpbWVfem9uZS56b25lKQogICAgYm9keSA9ICdIaSB7MH0uIFlvdSBoYXZlIGFuIGFwcG9pbnRtZW50IGNvbWluZyB1cCB7MX0uJy5mb3JtYXQoCiAgICAgICAgYXBwb2ludG1lbnQubmFtZSwKICAgICAgICBhcHBvaW50bWVudF90aW1lLmh1bWFuaXplKCkKICAgICkKCiAgICBtZXNzYWdlID0gY2xpZW50Lm1lc3NhZ2VzLmNyZWF0ZSgKICAgICAgICBib2R5PWJvZHksCiAgICAgICAgdG89YXBwb2ludG1lbnQucGhvbmVfbnVtYmVyLAogICAgICAgIGZyb21fPXNldHRpbmdzLlRXSUxJT19OVU1CRVIsCiAgICApCg==</textarea>
<textarea class="saurus-file" data-file="appointments/settings/common.py" data-mode="python">IiIiCkNvbW1vbiBEamFuZ28gc2V0dGluZ3MgZm9yIHRoZSBhcHBvaW50bWVudHMgcHJvamVjdC4KClNlZSB0aGUgbG9jYWwsIHRlc3QsIGFuZCBwcm9kdWN0aW9uIHNldHRpbmdzIG1vZHVsZXMgZm9yIHRoZSB2YWx1ZXMgdXNlZAppbiBlYWNoIGVudmlyb25tZW50LgoKRm9yIG1vcmUgaW5mb3JtYXRpb24gb24gdGhpcyBmaWxlLCBzZWUKaHR0cHM6Ly9kb2NzLmRqYW5nb3Byb2plY3QuY29tL2VuLzEuOC90b3BpY3Mvc2V0dGluZ3MvCgpGb3IgdGhlIGZ1bGwgbGlzdCBvZiBzZXR0aW5ncyBhbmQgdGhlaXIgdmFsdWVzLCBzZWUKaHR0cHM6Ly9kb2NzLmRqYW5nb3Byb2plY3QuY29tL2VuLzEuOC9yZWYvc2V0dGluZ3MvCiIiIgoKaW1wb3J0IG9zCgpCQVNFX0RJUiA9IG9zLnBhdGguZGlybmFtZShvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5hYnNwYXRoKF9fZmlsZV9fKSkpCgojIFNFQ1VSSVRZIFdBUk5JTkc6IGRvbid0IHJ1biB3aXRoIGRlYnVnIHR1cm5lZCBvbiBpbiBwcm9kdWN0aW9uIQpERUJVRyA9IEZhbHNlCgojIFNFQ1VSSVRZIFdBUk5JTkc6IGtlZXAgdGhlIHNlY3JldCBrZXkgdXNlZCBpbiBwcm9kdWN0aW9uIHNlY3JldCEKU0VDUkVUX0tFWSA9ICdub3Qtc28tc2VjcmV0JwoKIyBNb3N0IGltcG9ydGFudCBzZXR0aW5ncwoKIyBUd2lsaW8gQVBJClRXSUxJT19OVU1CRVIgPSBvcy5lbnZpcm9uLmdldCgnVFdJTElPX05VTUJFUicpCgojIEFkZHJlc3Mgb2YgUmVkaXMgaW5zdGFuY2UsIG91ciBDZWxlcnkgYnJva2VyCkJST0tFUl9VUkwgPSAncmVkaXM6Ly9sb2NhbGhvc3Q6NjM3OS8wJwpCUk9LRVJfUE9PTF9MSU1JVCA9IDgKCiMgUmVtaW5kZXIgdGltZTogaG93IGVhcmx5IHRleHQgbWVzc2FnZXMgYXJlIHNlbnQgaW4gYWR2YW5jZSBvZiBhcHBvaW50bWVudHMKUkVNSU5ERVJfVElNRSA9IDMwICMgbWludXRlcwoKQUxMT1dFRF9IT1NUUyA9IFtdCgojIEFwcGxpY2F0aW9uIGRlZmluaXRpb24KCkRKQU5HT19BUFBTID0gKAogICAgJ2RqYW5nby5jb250cmliLmFkbWluJywKICAgICdkamFuZ28uY29udHJpYi5hdXRoJywKICAgICdkamFuZ28uY29udHJpYi5jb250ZW50dHlwZXMnLAogICAgJ2RqYW5nby5jb250cmliLnNlc3Npb25zJywKICAgICdkamFuZ28uY29udHJpYi5tZXNzYWdlcycsCiAgICAnZGphbmdvLmNvbnRyaWIuc3RhdGljZmlsZXMnCikKClRISVJEX1BBUlRZX0FQUFMgPSAoCiAgICAnYm9vdHN0cmFwMycsCiAgICAnZGphbmdvX2Zvcm1zX2Jvb3RzdHJhcCcsCiAgICAndGltZXpvbmVfZmllbGQnCikKCkxPQ0FMX0FQUFMgPSAoCiAgICAncmVtaW5kZXJzJywKKQoKSU5TVEFMTEVEX0FQUFMgPSBESkFOR09fQVBQUyArIFRISVJEX1BBUlRZX0FQUFMgKyBMT0NBTF9BUFBTCgpNSURETEVXQVJFX0NMQVNTRVMgPSAoCiAgICAnZGphbmdvLmNvbnRyaWIuc2Vzc2lvbnMubWlkZGxld2FyZS5TZXNzaW9uTWlkZGxld2FyZScsCiAgICAnZGphbmdvLm1pZGRsZXdhcmUuY29tbW9uLkNvbW1vbk1pZGRsZXdhcmUnLAogICAgJ2RqYW5nby5taWRkbGV3YXJlLmNzcmYuQ3NyZlZpZXdNaWRkbGV3YXJlJywKICAgICdkamFuZ28uY29udHJpYi5hdXRoLm1pZGRsZXdhcmUuQXV0aGVudGljYXRpb25NaWRkbGV3YXJlJywKICAgICdkamFuZ28uY29udHJpYi5hdXRoLm1pZGRsZXdhcmUuU2Vzc2lvbkF1dGhlbnRpY2F0aW9uTWlkZGxld2FyZScsCiAgICAnZGphbmdvLmNvbnRyaWIubWVzc2FnZXMubWlkZGxld2FyZS5NZXNzYWdlTWlkZGxld2FyZScsCiAgICAnZGphbmdvLm1pZGRsZXdhcmUuY2xpY2tqYWNraW5nLlhGcmFtZU9wdGlvbnNNaWRkbGV3YXJlJywKICAgICdkamFuZ28ubWlkZGxld2FyZS5zZWN1cml0eS5TZWN1cml0eU1pZGRsZXdhcmUnLAopCgpST09UX1VSTENPTkYgPSAnYXBwb2ludG1lbnRzLnVybHMnCgpURU1QTEFURVMgPSBbCiAgICB7CiAgICAgICAgJ0JBQ0tFTkQnOiAnZGphbmdvLnRlbXBsYXRlLmJhY2tlbmRzLmRqYW5nby5EamFuZ29UZW1wbGF0ZXMnLAogICAgICAgICdESVJTJzogWyd0ZW1wbGF0ZXMvJ10sCiAgICAgICAgJ0FQUF9ESVJTJzogVHJ1ZSwKICAgICAgICAnT1BUSU9OUyc6IHsKICAgICAgICAgICAgJ2NvbnRleHRfcHJvY2Vzc29ycyc6IFsKICAgICAgICAgICAgICAgICdkamFuZ28udGVtcGxhdGUuY29udGV4dF9wcm9jZXNzb3JzLmRlYnVnJywKICAgICAgICAgICAgICAgICdkamFuZ28udGVtcGxhdGUuY29udGV4dF9wcm9jZXNzb3JzLnJlcXVlc3QnLAogICAgICAgICAgICAgICAgJ2RqYW5nby5jb250cmliLmF1dGguY29udGV4dF9wcm9jZXNzb3JzLmF1dGgnLAogICAgICAgICAgICAgICAgJ2RqYW5nby5jb250cmliLm1lc3NhZ2VzLmNvbnRleHRfcHJvY2Vzc29ycy5tZXNzYWdlcycsCiAgICAgICAgICAgIF0sCiAgICAgICAgfSwKICAgIH0sCl0KCkNSSVNQWV9URU1QTEFURV9QQUNLID0gJ2Jvb3RzdHJhcDMnCgpXU0dJX0FQUExJQ0FUSU9OID0gJ2FwcG9pbnRtZW50cy53c2dpLmFwcGxpY2F0aW9uJwoKCiMgRGF0YWJhc2UKIyBodHRwczovL2RvY3MuZGphbmdvcHJvamVjdC5jb20vZW4vMS44L3JlZi9zZXR0aW5ncy8jZGF0YWJhc2VzCgpEQVRBQkFTRVMgPSB7CiAgICAnZGVmYXVsdCc6IHsKICAgICAgICAnRU5HSU5FJzogJ2RqYW5nby5kYi5iYWNrZW5kcy5wb3N0Z3Jlc3FsX3BzeWNvcGcyJywKICAgICAgICAnTkFNRSc6ICdhcHBvaW50bWVudF9yZW1pbmRlcnMnCiAgICB9Cn0KCgojIEludGVybmF0aW9uYWxpemF0aW9uCiMgaHR0cHM6Ly9kb2NzLmRqYW5nb3Byb2plY3QuY29tL2VuLzEuOC90b3BpY3MvaTE4bi8KCkxBTkdVQUdFX0NPREUgPSAnZW4tdXMnCgpUSU1FX1pPTkUgPSAnVVRDJwoKVVNFX0kxOE4gPSBUcnVlCgpVU0VfTDEwTiA9IFRydWUKClVTRV9UWiA9IFRydWUKCgojIFN0YXRpYyBmaWxlcyAoQ1NTLCBKYXZhU2NyaXB0LCBJbWFnZXMpCiMgaHR0cHM6Ly9kb2NzLmRqYW5nb3Byb2plY3QuY29tL2VuLzEuOC9ob3d0by9zdGF0aWMtZmlsZXMvCgpTVEFUSUNfUk9PVCA9IEJBU0VfRElSICsgJy9zdGF0aWNmaWxlcycKClNUQVRJQ19VUkwgPSAnL3N0YXRpYy8nCg==</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>